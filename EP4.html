<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!-- saved from url=(0052)https://www.ime.usp.br/~cris/aulas/20_2_122/eps/ep1/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>EP1 - MAC122 - segundo semestre de 2020</title>
</head>

<body class="vsc-initialized">
<h1><font color="red">Primeiro Exercício-Programa</font></h1>

<h2>Estrelas de Koch, H-trees e mais...</h2>

<h3><font color="green">Entrega: 13 de setembro</font></h3>

O objetivo deste exercício-programa é utilizar recursão para gerar alguns fractais simples.
Fractais são figuras geométricas que podem ser divididas em partes semelhantes à figura original.
Por isso, a recursão é um recurso muito apropriado para gerar tais figuras. 

<p>

Começaremos apresentando dois fractais simples:
as <font color="green">curvas de Koch</font> e as <font color="green">árvores H</font> (<i>H trees</i>).
Você pode ler mais sobre eles na wikipedia:
</p><ul>
  <li> <a href="http://pt.wikipedia.org/wiki/Curva_de_Koch">Curva de Koch</a>
  </li><li> <a href="http://en.wikipedia.org/wiki/H_tree">H tree</a>
</li></ul>

As curvas de Koch são definidas da seguinte maneira. A curva de Koch de ordem 0 consiste em um segmento de reta.
A curva de Koch de ordem 1 é obtida a partir da curva de Koch de ordem 0 subdividindo o segmento em três
segmentos de mesmo comprimento, e substituindo a parte do meio por dois outros segmentos do comprimento da parte do meio,
formando um bico (como dois lados de um triângulo equilátero), como indicado pela figura abaixo.
Esse processo se repete a cada segmento da curva de Koch de ordem 1 para obtermos a curva de Koch de ordem 2, etc.

<p>

<table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tbody><tr>
    <td align="center">
    <img src="./EP1 - MAC122 - segundo semestre de 2020_files/curvas_de_Koch.jpg" border="0">
    <br>
    </td>
  </tr>
</tbody></table>

</p><p>

Uma variante da curva de Koch é a chamada <font color="green">estrela de Koch</font>, que é
obtida de três curvas de Koch cada uma obtida a partir de um dos lados de um triângulo equilátero.

</p><p>

<table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tbody><tr>
    <td align="center">
    <img src="./EP1 - MAC122 - segundo semestre de 2020_files/estrela_de_Koch.jpg" border="0">
    <br>
    </td>
  </tr>
</tbody></table>

</p><p>

As árvores H por sua vez são definidas da seguinte forma.
A árvore H de ordem 0 é mostrada na figura abaixo.
A árvore H de ordem 1 é obtida da de ordem 0 adicionando-se uma árvore H
de ordem 0 com a metade do seu tamanho, centrada em cada uma de suas folhas.
Similarmente, uma árvore H de ordem 2 é obtida da de ordem 0 adicionando-se uma
árvore H de ordem 1 com a metade do seu tamanho, centrada em cada uma de suas folhas, etc. 

</p><p>

<table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tbody><tr>
    <td align="center">
    <img src="./EP1 - MAC122 - segundo semestre de 2020_files/Htrees.jpg" border="0">
    <br>
    </td>
  </tr>
</tbody></table>

</p><p>

Estes são dois exemplos de construções recursivas.
Você está convidado a pensar em uma construção sua, que dê origem a uma família de figuras semelhante a estas. 

</p><h3> <font color="red">Entrada e saída do seu programa</font> </h3>

Você deverá escrever um programa que:
<ol>
<li> Leia do teclado um número, onde 0 indica estrela de Koch, 1 indica árvore H e 2 indica o seu fractal.
</li><li> Leia do teclado a ordem da figura a ser gerada.
</li><li> Leia do teclado o nome de um arquivo de saída que conterá a imagem gerada.
</li><li> Gere um arquivo postscript com a estrela de Koch, a árvore H ou o seu fractal, de acordo com a ordem dada.
  A imagem deve ter um tamanho semelhante às disponibilizadas abaixo.
</li></ol>

Não modifique a ordem dos dados na entrada e nem faça seu programa ler algo além dos dados acima,
pois o seu programa será submetido a um corretor automático.
Haverá um desconto na nota do seu EP se for feita alguma modificação no formato de leitura. 

<h3> <font color="red">Exemplos de saída</font> </h3>

<a href="https://www.ime.usp.br/~cris/aulas/20_2_122/eps/ep1/arquivos">Aqui</a> você encontra alguns arquivos pdf que foram obtidos dos arquivos ps gerados pelo meu programa. 

<h3> <font color="red">Linguagem postscript</font> </h3>

Postscript é uma linguagem completa cujos programas estão escritos em notação posfixa e são interpretados
com a ajuda de uma pilha interna, exatamente como no cálculo de expressões aritméticas em notação posfixa.
Cada operação obtém seus argumentos da pilha interna e deposita de volta nesta pilha seu valor de retorno.

<p>

Nesta seção, descreveremos apenas o necessário desta linguagem para que você possa implementar esse EP.
Esta descrição baseia-se numa parte da seção 4.3 do livro do Sedgewick, Algorithms in C. 

</p><p>

Os operadores aritméticos básicos em postscript são <i>add</i>, <i>sub</i>, <i>mul</i>, <i>div</i> (divisão em float)
e <i>idiv</i> (divisão inteira). Um exemplo de programa em postscript mostra como se pode utilizar estes operadores:
</p><center>
<b><font color="green">5 9 8 add 4 6 mul mul 7 add mul</font></b>
</center>
Sim, esta linha é um programa em postscript!
Interprete a linha acima como uma expressão em notação posfixa e pense em qual é o valor desta expressão.
Você deve obter o valor 2075. Confira!
Assim, ao final desse programa em postscript, este valor é o que fica na pilha interna. 

<p> 

Além destes operadores aritméticos, você pode achar útil o operador <i>neg</i>, que reverte o sinal do número no topo da pilha.

</p><p>

A linguagem postscritp (ps) tem um número de funções primitivas que servem de instrução para um dispositivo abstrato para desenhar.
A ação de cada função é em geral clara do seu nome. Estas funções são acionadas com argumentos que estejam na pilha. Por exemplo,
</p><center>
<b><font color="green">0 0 moveto 144 0 rlineto 60 rotate 144 0 rlineto stroke</font></b>
</center>
corresponde à seguinte sequência de ações: chame <i>moveto</i> com argumentos 0 e 0,
então chame <i>rlineto</i> com argumentos 144 e 0, depois <i>rotate</i> com argumento 60, etc.
Algumas funções se referem diretamente à própria pilha.
Por exemplo, o operador <i>dup</i> duplica a entrada do topo da pilha. Assim, por exemplo, o código
<center>
<b><font color="green">144 dup 0 rlineto 60 rotate dup 0 rlineto</font></b>
</center>
corresponde a:
chame <i>rlineto</i> com argumentos 144 e 0, depois <i>rotate</i> com argumento 60, então <i>rlineto</i> com argumentos 144 e 0.
Um outro operador que atua na pilha diretamente é o <i>pop</i>, que remove o elemento do topo da pilha (desempilha). 

<p>

A seguir, descrevemos com precisão a ação das funções mais básicas,
que devem ser suficientes para você gerar as figuras pedidas neste EP.
Antes disso, vamos descrever o dispositivo abstrato para desenhar.
O dispositivo consiste de uma página virtual, inicialmente em branco, com um sistema de coordenadas.
A origem deste sistema fica no canto inferior esquerdo da página, o eixo <i>x</i> é o horizontal e o eixo <i>y</i>, o vertical.
Além da página, temos uma caneta virtual.

</p><p>

A operação <i>moveto</i> remove dois números da pilha e trata-os como as coordenadas <i>x</i> e <i>y</i> para onde move a caneta.
A operação <i>rmoveto</i> é como o <i>moveto</i>, porém o movimento é relativo à posição corrente da caneta. Por exemplo, 
</p><center>
<b><font color="green">100 50 moveto 10 20 rmoveto</font></b>
</center>
faz com que a caneta primeiro mova para a posição (100,50), e depois para a posição (110,70). 

A operação <i>rotate</i> remove um número da pilha e executa uma rotação do sistema
de coordenadas deste número de graus no sentido anti-horário. Assim, após
<center>
<b><font color="green">100 50 moveto 90 rotate 10 20 rmoveto</font></b>
</center>
a caneta estará na posição (80,60). 

<p>

Até agora, não desenhamos nada. Apenas movemos a caneta.
O operador <i>lineto</i> remove dois números da pilha, tratando-os como as coordenadas <i>x</i> e <i>y</i> de um ponto,
e registra um segmento de reta do ponto onde está a caneta para o ponto (<i>x</i>,<i>y</i>).
A caneta termina no ponto (<i>x</i>,<i>y</i>).
O operador <i>rlineto</i> é semelhante, mas interpreta os dois números desempilhados como a posição relativa à posição corrente.
Vejamos um exemplo para entender melhor. Neste ponto, eu sugiro que você copie o programa ps abaixo
em um arquivo texto de nome <t>desenho.ps</t> e visualize o resultado abrindo este arquivo,
por exemplo, com o programa <a href="http://pages.cs.wisc.edu/~ghost/">ghostview (gv)</a> ou um equivalente.
</p><center>
<b><font color="green">150 250 moveto 200 400 lineto stroke</font></b>
</center>
O operador <i>stroke</i> conclui e imprime o desenho. Experimente alternativamente 
<center>
<b><font color="green">150 250 moveto 200 400 rlineto stroke</font></b>
</center>
e perceba a diferença.
No primeiro, o segmento desenhado e a caneta terminam na posição (200,400), enquanto que no segundo, terminam na posição (350,650). 

<p>

Além destes, um comando que pode ser útil para manipular a pilha é o <i>roll</i>.
Este comando remove dois números da pilha, digamos, <i>a</i> primeiro, depois <i>b</i>,
e rotaciona circularmente <i>a</i> vezes os <i>b</i> últimos números da pilha.
Por exemplo, ao final do programa
</p><center>
<b><font color="green">7 8 9 3 1 roll</font></b>
</center>
a pilha está com <b><font color="green">9 7 8</font></b>. Se <i>a</i> for negativo, a rotação é no sentido oposto.
Assim, ao final de
<center>
<b><font color="green">7 8 9 3 -1 roll</font></b>
</center>
a pilha está com <b><font color="green">8 9 7</font></b>.

<p>

Para mais informações sobre a linguagem postscript, consulte o seu
<a href="http://www-cdf.fnal.gov/offline/PostScript/BLUEBOOK.PDF">manual</a> completo.
No entanto, antes de usar no seu EP qualquer recurso da linguagem que não esteja entre os apresentados acima,
por favor, me consulte.

</p><h3><font color="red">Recomendações</font></h3>

Utilize recursão no seu programa para gerar o arquivo ps dos desenhos.
Se você não utilizar recursão, o seu EP receberá nota zero.

<p>

Comece brincando um pouco com postscript. Escreva um programa ps que desenhe a curva de Koch de ordem 1.
Uma vez que você tenha feito isso, tente escrever uma função recursiva em C que receba como parâmetro
um inteiro <i>n</i> ≥ 0 e imprima um arquivo ps que desenhe a curva de Koch de ordem <i>n</i>.
Depois disso, será fácil obter a estrela de Koch. 

</p><p>

Passe para a árvore H apenas depois de ter conseguido gerar o arquivo da estrela de Koch.
A árvore H dá um pouco mais de trabalho.

</p><p>

Para o seu fractal, você está liberado para usar outras funções da linguagem postscript,
como por exemplo funções que desenham arcos, ou círculos, etc. Divirta-se xeretando o manual.

</p><p>

Há recursão na linguagem postscript, mas não a use para desenhar a estrela de Koch ou a árvore H.
Se quiser, experimente no seu fractal.

</p><p>
<b><font color="purple">Divirta-se com o EP!</font></b>

</p><h3><font color="red">Entrega, prazos e observações</font></h3>

<ul>
  <li>O EP é estritamente individual.
  </li><li>O EP é estritamente individual. Usaremos um sistema para detecão de EPs copiados.
  </li><li>O EP é estritamente individual. Alunos envolvidos em cola serão reprovados na disciplina sem mais,
    e seus nomes serão encaminhados para a Comissão de Graduação para demais providências. 
  </li><li>Exercícios atrasados não serão aceitos.
  </li><li>Capriche na documentação do seu programa. 
  </li><li>Coloque o cabeçalho usual em seu programa (como em MAC110), com nome, número USP, curso, data,
    nome do professor e identificação do EP (EP1)...
  </li><li> A entrega do programa consiste da <b>entrega eletrônica</b> do programa.
    O seu <code>programa</code> deve ser entregue até dia 13 de setembro, inclusive.
</li></ul>

<hr>
<address></address>
 
</body></html>